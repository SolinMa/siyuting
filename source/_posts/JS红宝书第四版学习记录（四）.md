---
title: JS红宝书第四版学习记录（四）
date: 2020-11-19 17:41:21
tags:
---
### 基本引用类型

对象被认为是某个特定引用类型的实例。新对象通过使用 new 操作符后跟一个构造函数（constructor）来创建。构造函数就是用来创建新对象的函数。

#### Date

Date 类型重写了 toLocaleString()、toString()和 valueOf()方法。

Date 类型的 valueOf()方法根本就不返回字符串，这个方法被重写后返回的是日期的毫秒表示。
因此，操作符（如小于号和大于号）可以直接使用它返回的值。比如下面的例子：

```js
let date1 = new Date(2020, 0, 1); // 2020 年 1 月 1 日
let date2 = new Date(2020, 1, 1); // 2020 年 2 月 1 日
console.log(date1 < date2); // true
console.log(date1 > date2); // false
```

toLocaleString()和 toString()一样，会因浏览器而异。因此不能用于在用户界面上一致地显示日期。

#### RegExp

每个正则表达式可以带零个或多个 flags（标记），用于控制正则表达式的行为。下面给出了表示匹配模式的标记。

| flags（标记） | 含义 |
| --------------- | ---- |
| g | 全局模式，表示查找字符串的全部内容，而不是找到第一个匹配的内容就结束。|
| i | 不区分大小写，表示在查找匹配时忽略 pattern 和字符串的大小写。|
| m | 多行模式，表示查找到一行文本末尾时会继续查找。|
| y | 粘附模式，表示只查找从 lastIndex 开始及之后的字符串。|
| u | Unicode 模式，启用 Unicode 匹配。|
| s | dotAll 模式，表示元字符.匹配任何字符（包括\n 或\r）。|

正则表达式也可以使用 RegExp 构造函数来创建，它接收两个参数：模式字符串和（可选的）标记字符串，比如：

```js
// 匹配第一个"bat"或"cat"，忽略大小写
let pattern1 = /[bc]at/i;
// 跟 pattern1 一样，只不过是用构造函数创建的
let pattern2 = new RegExp("[bc]at", "i");
```

因为 RegExp 的模式参数是字符串，所以在某些情况下需要二次转义。所有元字符都必须二次转义，包括转义字符序列，如\n（\转义后的字符串是\\，在正则表达式字符串中则要写成\\\\）。下表展示了几个正则表达式的字面量形式，以及使用 RegExp 构造函数创建时对应的模式字符串。

| 字面量模式 | 对应的字符串 |
| ----------- | -------------- |
| /\[bc\]at/ | "\\[bc\\]at" |
| /\.at/ | "\\.at" |
| /name\/age/ | "name\\/age" |
| /\d.\d{1,2}/ | "\\d.\\d{1,2}" |
| /\w\\hello\\123/ | "\\w\\\\hello\\\\123" |

此外，使用 RegExp 也可以基于已有的正则表达式实例，并可选择性地修改它们的标记：

```js
const re1 = /cat/g;
console.log(re1); // "/cat/g"
const re2 = new RegExp(re1);
console.log(re2); // "/cat/g"
```

> RegExp 构造函数的所有属性都没有任何 Web 标准出处，因此不要在生产环境中使用它们。

~~未完待续~~